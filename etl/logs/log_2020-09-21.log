[2020-09-21 23:59:20,072] {main.py:14} INFO - ETL starting
[2020-09-21 23:59:20,073] {process_data_up_s3.py:21} INFO - Beging to files verification to processing...
[2020-09-21 23:59:20,073] {process_data_up_s3.py:28} INFO - files to process ['dca_dataset_loan_transactions.jsonl', 'hdi_human_development_index_hdig_value.jsonl', 'world_currencies_conversion_rates.csv', 'dca_dataset_utilization_and_claims.jsonl']
[2020-09-21 23:59:20,074] {process_data_up_s3.py:30} INFO - miss files []
[2020-09-21 23:59:20,075] {process_data_up_s3.py:32} INFO - improper files []
[2020-09-21 23:59:20,076] {process_data_up_s3.py:46} INFO - file to proccess jsonl
[2020-09-21 23:59:20,076] {process_json_file.py:24} INFO - reading and processing dataset.. dca_dataset_loan_transactions
[2020-09-21 23:59:20,859] {process_json_file.py:34} WARNING - Error in json loads "Guarantee Number": "524-DCA-04-002 (MicroEnt)", "Transaction Report ID": "339495", "Amount (USD)": "100000", "Currency Name": "UNITED STATES - DOLLAR", "End Date": "8/17/2017", "Business Sector": "Other Service", "City/Town": "Managua", "State/Province/Region Name": "Managua", "State/Province/Region Code": "NU10", "Country Name": "Nicaragua", "Region Name": "LATIN AMERICA & THE CARIBBEAN", "Latitude": "12.142387", "Longitude": "-86.255792", "Is Woman Owned?": "f", "Is First Time Borrower?": "f", "Business Size": "6--10"}
[2020-09-21 23:59:20,859] {process_json_file.py:34} WARNING - Error in json loads {"Guarantee Number": "524-DCA-04-002 (MicroEnt)", "Transaction Report ID": "363348", "Amount (USD)": "23200", "Currency Name": "UNITED STATES - DOLLAR", "End Date": "3/6/2017", "Business Sector": "Health", "City/Town": "Managua", "State/Province/Region Name": "Managua", "State/Province/Region Code": "NU10", "Country Name": "Nicaragua", "Region Name": "LATIN AMERICA & THE CARIBBEAN", "Latitude 12.142387", "Longitude": "-86.255792", "Is Woman Owned?": "f", "Is First Time Borrower?": "t", "Business Size": "1--5"}
[2020-09-21 23:59:20,859] {process_json_file.py:34} WARNING - Error in json loads {"Guarantee Number": "524-DCA-04-002 (MicroEnt)", "Transaction Report ID": "363353", "Amount (USD)": "40000", "Currency Name": "UNITED STATES - DOLLAR", "End Date": "3/7/2015", "Business Sector": "Other Service", "City/Town": "Managua", "State/Province/Region Name": "Managua", "State/Province/Region Code": "NU10", "Country Name": "Nicaragua", "Region Name": "LATIN AMERICA & THE CARIBBEAN", "Latitude: "12.142387", "Longitude": "-86.255792", "Is Woman Owned?": "f", "Is First Time Borrower?": "t", "Business Size": "11--50"}
[2020-09-21 23:59:20,859] {process_json_file.py:34} WARNING - Error in json loads 
[2020-09-21 23:59:22,134] {process_json_file.py:41} INFO - saving data into file.. dca_dataset_loan_transactions : 164318 rows
[2020-09-21 23:59:22,946] {process_data_up_s3.py:46} INFO - file to proccess jsonl
[2020-09-21 23:59:22,946] {process_json_file.py:24} INFO - reading and processing dataset.. hdi_human_development_index_hdig_value
[2020-09-21 23:59:22,953] {process_json_file.py:34} WARNING - Error in json loads {"id": "1022", "utc_created": "2016-01-07 10:10:52.689964", "utc_updated": "2016-01-07 10:10:52.690139", "country": "Kenya", "country_code": "KEN", "indicator_code": "137506", "indicator": "HDI: Human development index (HDIg) value", value": "459", "year": "1985"}
[2020-09-21 23:59:22,955] {process_json_file.py:34} WARNING - Error in json loads 
[2020-09-21 23:59:22,956] {process_json_file.py:34} WARNING - Error in json loads {"id": "1685", "utc_created": "2016-01-07 10:10:52.689964" "utc_updated": "2016-01-07 10:10:52.690139", "country": "Sudan", "country_code": "SDN", "indicator_code": "137506", "indicator": "HDI: Human development index (HDIg) value", "value": "458", "year": "2009"}
[2020-09-21 23:59:22,963] {process_json_file.py:41} INFO - saving data into file.. hdi_human_development_index_hdig_value : 2119 rows
[2020-09-21 23:59:22,989] {process_data_up_s3.py:50} INFO - file to proccess csv
[2020-09-21 23:59:22,991] {process_csv_file.py:18} INFO - reading and processing dataset.. world_currencies_conversion_rates
[2020-09-21 23:59:23,006] {process_csv_file.py:24} INFO - saving data into file.. world_currencies_conversion_rates : 1000 rows
[2020-09-21 23:59:23,024] {process_csv_file.py:27} INFO - data saved on file
[2020-09-21 23:59:23,039] {process_csv_file.py:24} INFO - saving data into file.. world_currencies_conversion_rates : 2000 rows
[2020-09-21 23:59:23,056] {process_csv_file.py:27} INFO - data saved on file
[2020-09-21 23:59:23,072] {process_csv_file.py:24} INFO - saving data into file.. world_currencies_conversion_rates : 3000 rows
[2020-09-21 23:59:23,090] {process_csv_file.py:27} INFO - data saved on file
[2020-09-21 23:59:23,096] {process_csv_file.py:24} INFO - saving data into file.. world_currencies_conversion_rates : 3230 rows
[2020-09-21 23:59:23,123] {process_csv_file.py:27} INFO - data saved on file
[2020-09-21 23:59:23,124] {process_data_up_s3.py:46} INFO - file to proccess jsonl
[2020-09-21 23:59:23,124] {process_json_file.py:24} INFO - reading and processing dataset.. dca_dataset_utilization_and_claims
[2020-09-21 23:59:23,130] {process_json_file.py:34} WARNING - Error in json loads {"Fiscal Year": "2014", "Guarantee Number": "306-DCA-14-003C", "Partner Name": "FMFB Afghanistan", "Country": "Afghanistan", "Guarantee Start Date": "2014/09/25" "Guarantee End Date": "2020/09/25", "Final Date for Placing Loans under Coverage": "2018/09/30", "Primary Target Segment": "Micro", "Secondary Target Segment(s)": "", "Primary Target Sector": "General", "Secondary Target Sector(s)": "", "Credit Agreement Type": "Portable Guarantee", "Status": "Active", "Guarantee Percentage": "40.00%", "Effective Maximum Cumulative Disbursements": "$3,000,000 ", "Cumulative Utilization": "$0 ", "Cumulative Utilization Percentage": "0.00%", "Cumulative Loans": "0", "Claims": "$0 ", "Recoveries": "$0 "}
[2020-09-21 23:59:23,131] {process_json_file.py:34} WARNING - Error in json loads 
[2020-09-21 23:59:23,141] {process_json_file.py:41} INFO - saving data into file.. dca_dataset_utilization_and_claims : 587 rows
[2020-09-21 23:59:23,151] {truncate_tables.py:11} INFO - begin truncating tables...
[2020-09-21 23:59:23,285] {truncate_tables.py:17} INFO - truncate table stage.dca_dataset_loan_transactions
[2020-09-21 23:59:23,292] {truncate_tables.py:17} INFO - truncate table stage.dca_dataset_utilization_and_claims
[2020-09-21 23:59:23,299] {truncate_tables.py:17} INFO - truncate table stage.hdi_human_development_index_hdig_value
[2020-09-21 23:59:23,313] {truncate_tables.py:17} INFO - truncate table stage.world_currencies_conversion_rates
[2020-09-21 23:59:23,343] {truncate_tables.py:22} INFO - tables truncated...
[2020-09-21 23:59:23,930] {data_insert_stg.py:23} INFO - inserting file dca_dataset_loan_transactions.snappy.parquet
[2020-09-21 23:59:51,679] {data_insert_stg.py:32} INFO - inserted <164318> rows
[2020-09-21 23:59:51,923] {data_insert_stg.py:23} INFO - inserting file dca_dataset_utilization_and_claims.snappy.parquet
[2020-09-21 23:59:52,059] {data_insert_stg.py:32} INFO - inserted <587> rows
[2020-09-21 23:59:52,221] {data_insert_stg.py:23} INFO - inserting file hdi_human_development_index_hdig_value.snappy.parquet
[2020-09-21 23:59:52,424] {data_insert_stg.py:32} INFO - inserted <2119> rows
[2020-09-21 23:59:52,620] {data_insert_stg.py:23} INFO - inserting file world_currencies_conversion_rates.snappy.parquet
[2020-09-21 23:59:53,041] {data_insert_stg.py:32} INFO - inserted <3230> rows
[2020-09-21 23:59:53,369] {data_insert_aux.py:16} INFO - Running query dca_dataset_loan_transactions
[2020-09-21 23:59:56,705] {data_insert_aux.py:22} INFO - Success to process dca_dataset_loan_transactions
[2020-09-21 23:59:56,837] {data_insert_aux.py:16} INFO - Running query dca_dataset_utilization_and_claims
[2020-09-21 23:59:56,861] {data_insert_aux.py:22} INFO - Success to process dca_dataset_utilization_and_claims
[2020-09-21 23:59:57,023] {data_insert_aux.py:16} INFO - Running query hdi_human_development_index_hdig_value
[2020-09-21 23:59:57,054] {data_insert_aux.py:22} INFO - Success to process hdi_human_development_index_hdig_value
[2020-09-21 23:59:57,239] {data_insert_aux.py:16} INFO - Running query world_currencies_conversion_rates
[2020-09-21 23:59:57,287] {data_insert_aux.py:22} INFO - Success to process world_currencies_conversion_rates
[2020-09-21 23:59:57,424] {data_insert_prd.py:18} INFO - Running query dca_dataset_loan_transactions
[2020-09-22 00:00:26,638] {data_insert_prd.py:23} INFO - Success to process dca_dataset_loan_transactions
[2020-09-22 00:00:26,824] {data_insert_prd.py:18} INFO - Running query dca_dataset_utilization_and_claims
[2020-09-22 00:00:26,998] {data_insert_prd.py:23} INFO - Success to process dca_dataset_utilization_and_claims
[2020-09-22 00:00:27,137] {data_insert_prd.py:18} INFO - Running query hdi_human_development_index_hdig_value
[2020-09-22 00:00:27,433] {data_insert_prd.py:23} INFO - Success to process hdi_human_development_index_hdig_value
[2020-09-22 00:00:27,658] {data_insert_prd.py:18} INFO - Running query world_currencies_conversion_rates
[2020-09-22 00:00:27,956] {data_insert_prd.py:23} INFO - Success to process world_currencies_conversion_rates
[2020-09-22 00:00:28,136] {main.py:57} INFO - ETL execution completed successfully
